<!DOCTYPE html>
<html>

<head>
    <title>JACOB - SysAdmin</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/style.css">
    <script src="config.js"></script>
    <script src="js/paho-mqtt-min.js"></script>
    <script src="js/shared.js"></script>
    <script src="js/tts.js"></script>
    <style>
        body {
            /* theme-jacob uses radial gradient in style.css, we keep that or enhance it */
            /* We rely on style.css body.theme-jacob rule, but let's make sure it's dark tech */
            background: radial-gradient(circle at center, #2e1515 0%, #000 90%);
            color: #ff3d00;
            /* theme-red */
        }

        .scanlines {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0), rgba(255, 255, 255, 0) 50%, rgba(0, 0, 0, 0.2) 50%, rgba(0, 0, 0, 0.2));
            background-size: 100% 4px;
        }

        .numpad-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            position: relative;
            z-index: 10;
        }

        .display-screen {
            background: rgba(40, 0, 0, 0.8);
            border: 2px solid var(--theme-red);
            border-radius: 4px;
            padding: 20px;
            width: 280px;
            text-align: center;
            font-family: var(--font-terminal);
            font-size: 2em;
            color: var(--theme-red);
            text-shadow: 0 0 10px var(--theme-red);
            min-height: 1.5em;
            margin-bottom: 20px;
            box-shadow: inset 0 0 20px rgba(255, 0, 0, 0.2);
        }

        .keypad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }

        .key {
            width: 70px;
            aspect-ratio: 1;
            background: rgba(255, 61, 0, 0.1);
            border: 2px solid var(--theme-red);
            border-radius: 12px;
            /* More techy, less round */
            color: var(--theme-red);
            font-size: 1.5em;
            font-family: var(--font-title);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.1s;
            user-select: none;
            justify-self: center;
        }

        .key:active {
            background: var(--theme-red);
            color: black;
            transform: scale(0.95);
            box-shadow: 0 0 20px var(--theme-red);
        }

        .key.action {
            border-radius: 4px;
            font-size: 1em;
        }

        .key.clear {
            border-style: dashed;
        }

        .key.enter {
            border-color: #f44336;
            /* Keep red theme for Jacob, maybe brighter */
            color: #f44336;
        }

        .key.enter:active {
            background: #f44336;
            color: black;
        }

        .shake {
            animation: shake 0.5s;
        }

        @keyframes shake {
            0% {
                transform: translateX(0);
            }

            25% {
                transform: translateX(-10px);
            }

            50% {
                transform: translateX(10px);
            }

            75% {
                transform: translateX(-10px);
            }

            100% {
                transform: translateX(0);
            }
        }

        /* Loading/Success Overlay */
        .overlay-msg {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
        }

        .overlay-msg.active {
            display: flex;
        }
    </style>
</head>

<body class="theme-jacob" data-snow="true">
    <div class="scanlines"></div>
    <div class="music-toggle" id="musicToggle">ðŸŽ¶</div>
    <audio id="bgm" loop>
        <source src="Merry Merry Everywhere.mp3" type="audio/mpeg">
    </audio>

    <!-- SCREEN 0: BOOT -->
    <div id="screen-boot" class="screen active">
        <h1 style="font-size: 3em; color: var(--theme-red); animation: glitch 0.3s infinite; text-shadow: 2px 2px red;">
            SYSTEM OFFLINE</h1>
        <p class="mono">ROOT ACCESS REQUIRED</p>
        <button onclick="startApp()"
            style="border-color: var(--theme-red); color: var(--theme-red);">AUTHENTICATE</button>
    </div>

    <!-- MAIN UI -->
    <div id="screen-app" class="screen">
        <div class="glass-panel" style="border-color: var(--theme-red);">
            <div class="hud-bar">
                <span><span class="status-light red" id="sys-light"></span>ROOT SHELL</span>
                <span>JACOB</span>
            </div>

            <div class="primary-panel">
                <div class="numpad-container">
                    <div class="display-screen" id="display">_ _ _ _</div>
                    <div class="keypad">
                        <div class="key" onclick="press(1)">1</div>
                        <div class="key" onclick="press(2)">2</div>
                        <div class="key" onclick="press(3)">3</div>
                        <div class="key" onclick="press(4)">4</div>
                        <div class="key" onclick="press(5)">5</div>
                        <div class="key" onclick="press(6)">6</div>
                        <div class="key" onclick="press(7)">7</div>
                        <div class="key" onclick="press(8)">8</div>
                        <div class="key" onclick="press(9)">9</div>
                        <div class="key action clear" onclick="clearInput()">CLR</div>
                        <div class="key" onclick="press(0)">0</div>
                        <div class="key action enter" onclick="submit()">ENT</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- OUTRO -->
    <div id="screen-outro" class="screen">
        <div class="glass-panel" style="text-align: center; border-color: var(--success);">
            <h1 style="color: var(--success);">SYSTEM ONLINE</h1>
            <p class="mono">ROOT ACCESS GRANTED</p>
            <div style="font-size: 5em; margin: 20px;">ðŸ’»</div>
        </div>
    </div>

    <script>
        // CONFIGURATION
        const SECRET_CODE = "12345"; // TODO: Update this with the real code if different

        let currentInput = "";

        AudioManager.init('bgm');

        function startApp() {
            document.getElementById('screen-boot').classList.remove('active');
            document.getElementById('screen-app').classList.add('active');
            updateDisplay();
        }

        function press(num) {
            if (currentInput.length < 5) {
                currentInput += num;
                updateDisplay();
            }
        }

        function clearInput() {
            currentInput = "";
            updateDisplay();
        }

        function updateDisplay() {
            const disp = document.getElementById('display');
            let text = currentInput;
            for (let i = 0; i < (5 - currentInput.length); i++) {
                text += " _";
            }
            disp.innerText = text;
            disp.classList.remove('shake');
        }

        function submit() {
            if (currentInput === SECRET_CODE) {
                // Success
                document.getElementById('display').style.color = 'var(--success)';
                document.getElementById('display').style.borderColor = 'var(--success)';
                document.getElementById('sys-light').className = 'status-light green';
                setTimeout(() => {
                    Network.sendSolve('jacob');
                    document.getElementById('screen-app').classList.remove('active');
                    document.getElementById('screen-outro').classList.add('active');
                }, 500);
            } else {
                // Fail
                const disp = document.getElementById('display');
                disp.style.borderColor = 'red';
                disp.style.color = 'red';
                disp.classList.add('shake');
                setTimeout(() => {
                    currentInput = "";
                    disp.style.borderColor = 'var(--theme-red)';
                    disp.style.color = 'var(--theme-red)';
                    updateDisplay();
                }, 800);
            }
        }
    </script>
</body>

</html>